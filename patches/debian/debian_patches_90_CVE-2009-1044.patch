(CVE-2009-1044) XUL <tree> _moveToEdgeShift garbage-collection exploit (zdi-can-465)
https://bugzilla.mozilla.org/show_bug.cgi?id=484320
https://bugzilla.mozilla.org/attachment.cgi?id=368977
--- a/mozilla/layout/xul/base/src/tree/src/nsTreeSelection.cpp
+++ b/mozilla/layout/xul/base/src/tree/src/nsTreeSelection.cpp
@@ -265,6 +265,8 @@ nsTreeSelection::nsTreeSelection(nsITree
 nsTreeSelection::~nsTreeSelection()
 {
   delete mFirstRange;
+  if (mSelectTimer)
+    mSelectTimer->Cancel();
 }
 
 // QueryInterface implementation for nsBoxObject
